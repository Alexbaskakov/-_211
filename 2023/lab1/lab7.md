# Конфигурация Wireguard VPN
В текущей работе будет рассмотрена деятельность по установке соединения VPN WireGuard на платформе Mikrotik RouterOS 7.3.1. Ранее данная конфигурация была недоступна, однако выпуск версии программного обеспечения 7.3.1 позволил организовать соответствующий туннель в данной операционной системе. Преимущества механизма подключения WireGuard заключаются в следующих особенностях:
- UDP соединение;
- Проходимость через NAT;
- Гибкое управление интерфейсами;
Из минусов — это отсутствие сохранения состояния и ручное назначение адресов на интерфейсы, как клиентские, так и серверные. Да, тут стоит оговориться, что это не клиент-серверная технология, в понятии протокола есть Peer, который может как принимать соединения, так и инициировать.
> То есть тут нет настройки wireguard server и client как в привычных VPN протоколах на MikroTik. В данном случае оба конца сети равнозначны.
Общая идеология строится на том, что у обоих пиров есть приватный и публичные ключи. Это обычная строка цифр и символов сгенерированная в BASE64 кодировке. Всякий раз, когда вы создаёте WireGuard интерфейс, генерируется случайная последовательность ключа. Приватный ключ никому передавать нельзя, а вот публичный нужен для настройки с двух сторон. Первой стороне нужен ключ со второй стороны, и наоборот, второй стороне нужен ключ первой.
Т.е. простыми словами, у вас нет логина и пароля. Все обоюдно, шифруется публичными ключами каждой из сторон. Давайте перейдём от слов к делу и посмотрим на схему сети.

## Схема сети
В нашем случае  имеется провайдер со своей сетью, внутри которой мы будем и настраивать туннель. И далее внутри него, настроим маршрутизацию между площадками.
Такую схему можно собрать на виртуальных машинах, тогда, в случае использования Virtualbox, требуется эмулировать работу двух компьютеров и отдельных подсетей. Виртуальные адаптеры хоста №1 и №2 для соединений пк1 и пк2 соответственно, такие-же параметры на ether2 для office-1 и office-2. На eth1 для office-1 следует выбрать тип соединения "внутренняя сеть", аналогично для office-2. При этом они должны находиться в двух разных внутренних сетях с разной адресацией. ISP подключается также к двум настроенным внутренним сетям.
Схему также можно собрать и в GNS3, но в этом случае не будет возможности открыть WinBox напрямую и настройка будет производиться в терминале или в web-интерфейсе маршрутизатора.
![](https://mikrotiklab.ru/wp-content/uploads/2022/07/Wireguard-shema-seti.jpg)
## Настройка Office-1
Открываем меню WireGuard и создаём интерфейс. Имя можно задать какое угодно, в примере указано направление отправки пакетов.
!()[https://mikrotiklab.ru/wp-content/uploads/2022/07/Sozdanie-pervogo-WireGuard-v-Office-1.png.jpg]
Listen Port можете поменять, а можете оставить по умолчанию. Нажимаем применить и видим наш Private и Public.
!()[https://mikrotiklab.ru/wp-content/uploads/2022/07/Prosmotr-publichnogo-i-privatnogo-klyucha-WireGuard-1.jpg]
